INFO:root:Namespace(model_name='NeuMF', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-29 23:40:02 ---------------------------------------------
INFO:root:
=================================
 Arguments          | Values     
=================================
 batch_size         | 512       
 data_appendix      |           
 dataset            | ML_1MTOPK 
 dropout            | 0.2       
 early_stop         | 10        
 emb_size           | 64        
 epoch              | 200       
 eval_batch_size    | 512       
 gpu                | 0         
 l2                 | 1e-07     
 layers             | [64]      
 lr                 | 0.0005    
 main_metric        |           
 num_neg            | 1         
 num_workers        | 5         
 optimizer          | Adam      
 random_seed        | 0         
 save_final_results | 1         
 test_all           | 0         
 topk               | 5,10,20,50
=================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/ML_1MTOPK/BaseReader.pkl
INFO:root:#params: 1180736
INFO:root:NeuMF(
  (mf_u_embeddings): Embedding(6033, 64)
  (mf_i_embeddings): Embedding(3126, 64)
  (mlp_u_embeddings): Embedding(6033, 64)
  (mlp_i_embeddings): Embedding(3126, 64)
  (mlp): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
  )
  (dropout_layer): Dropout(p=0.2, inplace=False)
  (prediction): Linear(in_features=128, out_features=1, bias=False)
)
INFO:root:Test Before Training: (HR@5:0.0553,NDCG@5:0.0331,HR@10:0.0974,NDCG@10:0.0466,HR@20:0.2025,NDCG@20:0.0728,HR@50:0.4965,NDCG@50:0.1304)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3750 [5.0 s]	dev=(HR@5:0.3536,NDCG@5:0.2342) [0.1 s] *
INFO:root:Epoch 2     loss=0.2880 [3.9 s]	dev=(HR@5:0.3763,NDCG@5:0.2541) [0.1 s] *
INFO:root:Epoch 3     loss=0.2457 [4.0 s]	dev=(HR@5:0.3798,NDCG@5:0.2591) [0.1 s] *
INFO:root:Epoch 4     loss=0.2242 [4.0 s]	dev=(HR@5:0.3813,NDCG@5:0.2589) [0.1 s]
INFO:root:Epoch 5     loss=0.2109 [4.0 s]	dev=(HR@5:0.3899,NDCG@5:0.2637) [0.1 s] *
INFO:root:Epoch 6     loss=0.2007 [4.1 s]	dev=(HR@5:0.3934,NDCG@5:0.2673) [0.1 s] *
INFO:root:Epoch 7     loss=0.1922 [4.0 s]	dev=(HR@5:0.3938,NDCG@5:0.2661) [0.1 s]
INFO:root:Epoch 8     loss=0.1855 [4.0 s]	dev=(HR@5:0.3973,NDCG@5:0.2658) [0.1 s]
INFO:root:Epoch 9     loss=0.1793 [4.0 s]	dev=(HR@5:0.3903,NDCG@5:0.2621) [0.1 s]
INFO:root:Epoch 10    loss=0.1736 [4.1 s]	dev=(HR@5:0.3907,NDCG@5:0.2620) [0.1 s]
INFO:root:Epoch 11    loss=0.1685 [4.0 s]	dev=(HR@5:0.3950,NDCG@5:0.2640) [0.1 s]
INFO:root:Epoch 12    loss=0.1640 [4.0 s]	dev=(HR@5:0.3934,NDCG@5:0.2622) [0.1 s]
INFO:root:Epoch 13    loss=0.1581 [4.1 s]	dev=(HR@5:0.3868,NDCG@5:0.2577) [0.1 s]
INFO:root:Epoch 14    loss=0.1530 [4.0 s]	dev=(HR@5:0.3919,NDCG@5:0.2613) [0.1 s]
INFO:root:Epoch 15    loss=0.1508 [3.9 s]	dev=(HR@5:0.3997,NDCG@5:0.2635) [0.1 s]
INFO:root:Early stop at 15 based on dev result.
INFO:root:
Best Iter(dev)=    6	 dev=(HR@5:0.3934,NDCG@5:0.2673) [62.8 s] 
INFO:root:Load model from ../model/NeuMF/NeuMF__ML_1MTOPK__0__lr=0.0005__l2=1e-07__emb_size=64__layers=[64].pt
INFO:root:
Dev  After Training: (HR@5:0.3934,NDCG@5:0.2673,HR@10:0.5539,NDCG@10:0.3191,HR@20:0.7646,NDCG@20:0.3723,HR@50:0.9442,NDCG@50:0.4083)
INFO:root:
Test After Training: (HR@5:0.3845,NDCG@5:0.2581,HR@10:0.5505,NDCG@10:0.3113,HR@20:0.7457,NDCG@20:0.3608,HR@50:0.9509,NDCG@50:0.4022)
INFO:root:Saving top-100 recommendation results to: ../log/NeuMF/NeuMF__ML_1MTOPK__0__lr=0/rec-NeuMF-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/NeuMF/NeuMF__ML_1MTOPK__0__lr=0/rec-NeuMF-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-29 23:41:08 ---------------------------------------------
