INFO:root:Namespace(model_name='StagewiseGCN', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-29 23:44:38 ---------------------------------------------
INFO:root:
===========================================
 Arguments          | Values               
===========================================
 batch_size         | 512                 
 c                  | 0.05                
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0                   
 early_stop         | 10                  
 emb_size           | 64                  
 epoch              | 500                 
 eval_batch_size    | 512                 
 even_layer         | 2                   
 gpu                | 0                   
 l2                 | 0.0                 
 lr                 | 0.0001              
 main_metric        |                     
 n_layers           | 3                   
 n_stages           | 3                   
 num_neg            | 1                   
 num_workers        | 5                   
 odd_layer          | 2                   
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 test_all           | 0                   
 topk               | 5,10,20,50          
===========================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:[StagewiseBase] Initializing model with emb_size=64, n_layers=3
INFO:root:[StagewiseBase] Preparing stage-wise normalized adjacency matrices
INFO:root:[StagewiseBase] Stage 1 normalized adjacency matrix shape: (23396, 23396), nnz: 267180
INFO:root:[StagewiseBase] Stage 2 normalized adjacency matrix shape: (23396, 23396), nnz: 267180
INFO:root:[StagewiseBase] Stage 3 normalized adjacency matrix shape: (23396, 23396), nnz: 267180
INFO:root:[StagewiseBase] Defining encoder with stage 1 norm_adj
INFO:root:#params: 1497344
INFO:root:StagewiseGCN(
  (encoder): _LGCNEncoder(
    (embedding_dict): ParameterDict(
        (item_emb): Parameter containing: [torch.cuda.FloatTensor of size 8714x64 (cuda:0)]
        (user_emb): Parameter containing: [torch.cuda.FloatTensor of size 14682x64 (cuda:0)]
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.0612,NDCG@5:0.0372,HR@10:0.1103,NDCG@10:0.0529,HR@20:0.2096,NDCG@20:0.0777,HR@50:0.5184,NDCG@50:0.1378)
INFO:root:开始第 1/3 阶段训练
INFO:root:[StagewiseBase] Switched to stage 1
INFO:root:Optimizer: Adam
INFO:root:[Stage 1][Epoch 1] loss=1.3439 [3.3s] dev=({'NDCG@5': 0.1493049044402909, 'HR@5': 0.23370342619712553}) *
INFO:root:[Stage 1][Epoch 2] loss=1.1673 [2.2s] dev=({'NDCG@5': 0.1545547136593389, 'HR@5': 0.24160479531367074}) *
INFO:root:[Stage 1][Epoch 3] loss=1.0532 [2.2s] dev=({'NDCG@5': 0.16281785887829467, 'HR@5': 0.25304815748246035}) *
INFO:root:[Stage 1][Epoch 4] loss=0.9937 [2.2s] dev=({'NDCG@5': 0.17224061386586598, 'HR@5': 0.2677610516994755}) *
INFO:root:[Stage 1][Epoch 5] loss=0.9496 [2.2s] dev=({'NDCG@5': 0.18176232508779655, 'HR@5': 0.2792044138682651}) *
INFO:root:[Stage 1][Epoch 6] loss=0.9122 [2.2s] dev=({'NDCG@5': 0.18983157765278616, 'HR@5': 0.2894217015189701}) *
INFO:root:[Stage 1][Epoch 7] loss=0.8789 [2.3s] dev=({'NDCG@5': 0.19690352690034102, 'HR@5': 0.29861726040460457}) *
INFO:root:[Stage 1][Epoch 8] loss=0.8513 [2.2s] dev=({'NDCG@5': 0.2021115221424002, 'HR@5': 0.3051563245010558}) *
INFO:root:[Stage 1][Epoch 9] loss=0.8317 [2.2s] dev=({'NDCG@5': 0.20775391772887425, 'HR@5': 0.3123084258565493}) *
INFO:root:[Stage 1][Epoch 10] loss=0.8145 [2.2s] dev=({'NDCG@5': 0.2117217463625543, 'HR@5': 0.3168040324228595}) *
INFO:root:[Stage 1][Epoch 11] loss=0.7988 [2.2s] dev=({'NDCG@5': 0.2157113932567918, 'HR@5': 0.32177644574620257}) *
INFO:root:[Stage 1][Epoch 12] loss=0.7835 [2.2s] dev=({'NDCG@5': 0.22055406638021172, 'HR@5': 0.3292691233567196}) *
INFO:root:[Stage 1][Epoch 13] loss=0.7763 [2.2s] dev=({'NDCG@5': 0.22533485148579935, 'HR@5': 0.3351270349431238}) *
INFO:root:[Stage 1][Epoch 14] loss=0.7659 [2.2s] dev=({'NDCG@5': 0.22955827651492194, 'HR@5': 0.3398269872624481}) *
INFO:root:[Stage 1][Epoch 15] loss=0.7470 [2.2s] dev=({'NDCG@5': 0.23341142759888783, 'HR@5': 0.34418636332674885}) *
INFO:root:[Stage 1][Epoch 16] loss=0.7365 [2.2s] dev=({'NDCG@5': 0.23667098829206323, 'HR@5': 0.34738778012396976}) *
INFO:root:[Stage 1][Epoch 17] loss=0.7240 [2.2s] dev=({'NDCG@5': 0.24048051640001036, 'HR@5': 0.35147469518425173}) *
INFO:root:[Stage 1][Epoch 18] loss=0.7191 [2.3s] dev=({'NDCG@5': 0.24376751754962347, 'HR@5': 0.35542537974252436}) *
INFO:root:[Stage 1][Epoch 19] loss=0.7045 [2.2s] dev=({'NDCG@5': 0.24708823559892318, 'HR@5': 0.35944417955180163}) *
INFO:root:[Stage 1][Epoch 20] loss=0.6961 [2.2s] dev=({'NDCG@5': 0.25025918286430976, 'HR@5': 0.36244125059600846}) *
INFO:root:[Stage 1][Epoch 21] loss=0.6863 [2.2s] dev=({'NDCG@5': 0.2521929186440919, 'HR@5': 0.36502963013418704}) *
INFO:root:[Stage 1][Epoch 22] loss=0.6796 [2.2s] dev=({'NDCG@5': 0.2547691647766348, 'HR@5': 0.36748177917035624}) *
INFO:root:[Stage 1][Epoch 23] loss=0.6714 [2.2s] dev=({'NDCG@5': 0.2570032820200164, 'HR@5': 0.37047885021456306}) *
INFO:root:[Stage 1][Epoch 24] loss=0.6639 [2.2s] dev=({'NDCG@5': 0.2602322974032717, 'HR@5': 0.37436141952183094}) *
INFO:root:[Stage 1][Epoch 25] loss=0.6527 [2.2s] dev=({'NDCG@5': 0.2625740020574573, 'HR@5': 0.37803964307608473}) *
INFO:root:[Stage 1][Epoch 26] loss=0.6489 [2.2s] dev=({'NDCG@5': 0.26480493744164074, 'HR@5': 0.3806280226142633}) *
INFO:root:[Stage 1][Epoch 27] loss=0.6434 [2.2s] dev=({'NDCG@5': 0.267041930969252, 'HR@5': 0.3830120563994278}) *
INFO:root:[Stage 1][Epoch 28] loss=0.6342 [2.2s] dev=({'NDCG@5': 0.26961121870014687, 'HR@5': 0.38607724269463933}) *
INFO:root:[Stage 1][Epoch 29] loss=0.6252 [2.2s] dev=({'NDCG@5': 0.2715621091935741, 'HR@5': 0.3875757782167427}) *
INFO:root:[Stage 1][Epoch 30] loss=0.6206 [2.2s] dev=({'NDCG@5': 0.2729548523375572, 'HR@5': 0.38921054424085555}) *
INFO:root:[Stage 1][Epoch 31] loss=0.6108 [2.2s] dev=({'NDCG@5': 0.27504142316611807, 'HR@5': 0.39159457802602005}) *
INFO:root:[Stage 1][Epoch 32] loss=0.6049 [2.2s] dev=({'NDCG@5': 0.27696887246315577, 'HR@5': 0.3937742660581704}) *
INFO:root:[Stage 1][Epoch 33] loss=0.6026 [2.2s] dev=({'NDCG@5': 0.2785583893383749, 'HR@5': 0.39506845582725975}) *
INFO:root:[Stage 1][Epoch 34] loss=0.5910 [2.3s] dev=({'NDCG@5': 0.2792830417537168, 'HR@5': 0.3956133778352973}) *
INFO:root:[Stage 1][Epoch 35] loss=0.5887 [2.2s] dev=({'NDCG@5': 0.28014869586479174, 'HR@5': 0.3967032218513725}) *
INFO:root:[Stage 1][Epoch 36] loss=0.5839 [2.2s] dev=({'NDCG@5': 0.2813665607351263, 'HR@5': 0.39847421837749475}) *
INFO:root:[Stage 1][Epoch 37] loss=0.5746 [2.2s] dev=({'NDCG@5': 0.28174103644006826, 'HR@5': 0.3994278318915605}) *
INFO:root:[Stage 1][Epoch 38] loss=0.5737 [2.2s] dev=({'NDCG@5': 0.28269137117833654, 'HR@5': 0.40085825216265925}) *
INFO:root:[Stage 1][Epoch 39] loss=0.5680 [2.2s] dev=({'NDCG@5': 0.2829771050463361, 'HR@5': 0.400449560656631}) *
INFO:root:[Stage 1][Epoch 40] loss=0.5622 [2.2s] dev=({'NDCG@5': 0.2838504923609713, 'HR@5': 0.401811865676725}) *
INFO:root:[Stage 1][Epoch 41] loss=0.5548 [2.2s] dev=({'NDCG@5': 0.28450109969905985, 'HR@5': 0.4029017096928002}) *
INFO:root:[Stage 1][Epoch 42] loss=0.5545 [2.2s] dev=({'NDCG@5': 0.28511445330926993, 'HR@5': 0.40351474695184253}) *
INFO:root:[Stage 1][Epoch 43] loss=0.5464 [2.2s] dev=({'NDCG@5': 0.2854684974422074, 'HR@5': 0.4040596689598801}) *
INFO:root:[Stage 1][Epoch 44] loss=0.5434 [2.2s] dev=({'NDCG@5': 0.28641159116783654, 'HR@5': 0.40569443498399294}) *
INFO:root:[Stage 1][Epoch 45] loss=0.5386 [2.2s] dev=({'NDCG@5': 0.28633363123744593, 'HR@5': 0.40521762822696})
INFO:root:[Stage 1][Epoch 46] loss=0.5376 [2.2s] dev=({'NDCG@5': 0.2872791790821547, 'HR@5': 0.40576255023499763}) *
INFO:root:[Stage 1][Epoch 47] loss=0.5314 [2.2s] dev=({'NDCG@5': 0.28762040757513424, 'HR@5': 0.40685239425107284}) *
INFO:root:[Stage 1][Epoch 48] loss=0.5262 [2.2s] dev=({'NDCG@5': 0.2879047120176815, 'HR@5': 0.40678427900006814}) *
INFO:root:[Stage 1][Epoch 49] loss=0.5216 [2.3s] dev=({'NDCG@5': 0.28821095122635865, 'HR@5': 0.40685239425107284}) *
INFO:root:[Stage 1][Epoch 50] loss=0.5182 [2.2s] dev=({'NDCG@5': 0.28853393704276015, 'HR@5': 0.4073292010081057}) *
INFO:root:[Stage 1][Epoch 51] loss=0.5223 [2.2s] dev=({'NDCG@5': 0.2887734584651847, 'HR@5': 0.40787412301614334}) *
INFO:root:[Stage 1][Epoch 52] loss=0.5118 [2.2s] dev=({'NDCG@5': 0.28927539075229397, 'HR@5': 0.408623390777195}) *
INFO:root:[Stage 1][Epoch 53] loss=0.5104 [2.2s] dev=({'NDCG@5': 0.2896138257264396, 'HR@5': 0.40916831278523264}) *
INFO:root:[Stage 1][Epoch 54] loss=0.5050 [2.2s] dev=({'NDCG@5': 0.29000158488761274, 'HR@5': 0.4097132347932702}) *
INFO:root:[Stage 1][Epoch 55] loss=0.5029 [2.2s] dev=({'NDCG@5': 0.2905768219028284, 'HR@5': 0.4105987330563313}) *
INFO:root:[Stage 1][Epoch 56] loss=0.4983 [2.2s] dev=({'NDCG@5': 0.2908124371469279, 'HR@5': 0.41025815680130784}) *
INFO:root:[Stage 1][Epoch 57] loss=0.4983 [2.2s] dev=({'NDCG@5': 0.2906450866086175, 'HR@5': 0.4097813500442749})
INFO:root:[Stage 1][Epoch 58] loss=0.4904 [2.2s] dev=({'NDCG@5': 0.29103683457554996, 'HR@5': 0.4105306178053266}) *
INFO:root:[Stage 1][Epoch 59] loss=0.4880 [2.2s] dev=({'NDCG@5': 0.2912705159704191, 'HR@5': 0.4109393093113548}) *
INFO:root:[Stage 1][Epoch 60] loss=0.4858 [2.2s] dev=({'NDCG@5': 0.29174054386983755, 'HR@5': 0.41148423131939244}) *
INFO:root:[Stage 1][Epoch 61] loss=0.4879 [2.2s] dev=({'NDCG@5': 0.29192639180810315, 'HR@5': 0.4117566923234112}) *
INFO:root:[Stage 1][Epoch 62] loss=0.4833 [2.2s] dev=({'NDCG@5': 0.2923729453696974, 'HR@5': 0.41264219058647233}) *
INFO:root:[Stage 1][Epoch 63] loss=0.4748 [2.2s] dev=({'NDCG@5': 0.2927424159732333, 'HR@5': 0.4133233430965193}) *
INFO:root:[Stage 1][Epoch 64] loss=0.4717 [2.3s] dev=({'NDCG@5': 0.29338082626848305, 'HR@5': 0.4142088413595804}) *
INFO:root:[Stage 1][Epoch 65] loss=0.4681 [2.2s] dev=({'NDCG@5': 0.29381010752209963, 'HR@5': 0.414753763367618}) *
INFO:root:[Stage 1][Epoch 66] loss=0.4700 [2.2s] dev=({'NDCG@5': 0.2947022139575026, 'HR@5': 0.4156392616306791}) *
INFO:root:[Stage 1][Epoch 67] loss=0.4674 [2.2s] dev=({'NDCG@5': 0.29461905391177257, 'HR@5': 0.4155030311286697})
INFO:root:[Stage 1][Epoch 68] loss=0.4587 [2.2s] dev=({'NDCG@5': 0.2948666956054128, 'HR@5': 0.4155030311286697}) *
INFO:root:[Stage 1][Epoch 69] loss=0.4581 [2.2s] dev=({'NDCG@5': 0.2952249609951343, 'HR@5': 0.4157073768816838}) *
INFO:root:[Stage 1][Epoch 70] loss=0.4557 [2.2s] dev=({'NDCG@5': 0.2958122332266774, 'HR@5': 0.4172059124037872}) *
INFO:root:[Stage 1][Epoch 71] loss=0.4533 [2.2s] dev=({'NDCG@5': 0.2962591680033642, 'HR@5': 0.4176146039098154}) *
INFO:root:[Stage 1][Epoch 72] loss=0.4537 [2.2s] dev=({'NDCG@5': 0.29628096723506875, 'HR@5': 0.4176827191608201}) *
INFO:root:[Stage 1][Epoch 73] loss=0.4491 [2.2s] dev=({'NDCG@5': 0.29611677240183204, 'HR@5': 0.41727402765479193})
INFO:root:[Stage 1][Epoch 74] loss=0.4434 [2.2s] dev=({'NDCG@5': 0.29661682159841934, 'HR@5': 0.4176146039098154}) *
INFO:root:[Stage 1][Epoch 75] loss=0.4414 [2.2s] dev=({'NDCG@5': 0.29696670811177595, 'HR@5': 0.4175464886588107}) *
INFO:root:[Stage 1][Epoch 76] loss=0.4398 [2.2s] dev=({'NDCG@5': 0.29728455333833326, 'HR@5': 0.4178870649138342}) *
INFO:root:[Stage 1][Epoch 77] loss=0.4356 [2.3s] dev=({'NDCG@5': 0.29741097426581664, 'HR@5': 0.4178870649138342}) *
INFO:root:[Stage 1][Epoch 78] loss=0.4363 [2.2s] dev=({'NDCG@5': 0.29795584870529285, 'HR@5': 0.41856821742388123}) *
INFO:root:[Stage 1][Epoch 79] loss=0.4270 [2.2s] dev=({'NDCG@5': 0.2982031246537402, 'HR@5': 0.4191812546829235}) *
INFO:root:[Stage 1][Epoch 80] loss=0.4328 [2.2s] dev=({'NDCG@5': 0.2985565218411642, 'HR@5': 0.41965806143995643}) *
INFO:root:[Stage 1][Epoch 81] loss=0.4278 [2.2s] dev=({'NDCG@5': 0.29902118081142187, 'HR@5': 0.420202983447994}) *
INFO:root:[Stage 1][Epoch 82] loss=0.4230 [2.2s] dev=({'NDCG@5': 0.29912166789758443, 'HR@5': 0.42088413595804103}) *
INFO:root:[Stage 1][Epoch 83] loss=0.4224 [2.2s] dev=({'NDCG@5': 0.299568820882118, 'HR@5': 0.4216334037190927}) *
INFO:root:[Stage 1][Epoch 84] loss=0.4231 [2.2s] dev=({'NDCG@5': 0.30027874471594074, 'HR@5': 0.422246440978135}) *
INFO:root:[Stage 1][Epoch 85] loss=0.4168 [2.2s] dev=({'NDCG@5': 0.3007353328090079, 'HR@5': 0.422927593488182}) *
INFO:root:[Stage 1][Epoch 86] loss=0.4129 [2.2s] dev=({'NDCG@5': 0.3012657195619574, 'HR@5': 0.4236768612492337}) *
INFO:root:[Stage 1][Epoch 87] loss=0.4124 [2.2s] dev=({'NDCG@5': 0.30171303076806205, 'HR@5': 0.4238130917512431}) *
INFO:root:[Stage 1][Epoch 88] loss=0.4079 [2.2s] dev=({'NDCG@5': 0.3019170601699084, 'HR@5': 0.4240855527552619}) *
INFO:root:[Stage 1][Epoch 89] loss=0.4085 [2.2s] dev=({'NDCG@5': 0.3024134298326196, 'HR@5': 0.4244942442612901}) *
INFO:root:[Stage 1][Epoch 90] loss=0.4071 [2.2s] dev=({'NDCG@5': 0.30308501525866083, 'HR@5': 0.4255840882773653}) *
INFO:root:[Stage 1][Epoch 91] loss=0.3983 [2.3s] dev=({'NDCG@5': 0.30357586662940134, 'HR@5': 0.4261290102854029}) *
INFO:root:[Stage 1][Epoch 92] loss=0.3983 [2.2s] dev=({'NDCG@5': 0.3038697504816941, 'HR@5': 0.4271507390504734}) *
INFO:root:[Stage 1][Epoch 93] loss=0.3979 [2.2s] dev=({'NDCG@5': 0.30447049241661495, 'HR@5': 0.4284449288195627}) *
INFO:root:[Stage 1][Epoch 94] loss=0.3955 [2.2s] dev=({'NDCG@5': 0.3048195474708008, 'HR@5': 0.4295347728356379}) *
INFO:root:[Stage 1][Epoch 95] loss=0.3951 [2.2s] dev=({'NDCG@5': 0.30519240754913113, 'HR@5': 0.4298753490906614}) *
INFO:root:[Stage 1][Epoch 96] loss=0.3884 [2.2s] dev=({'NDCG@5': 0.30567054864048077, 'HR@5': 0.4305565016007084}) *
INFO:root:[Stage 1][Epoch 97] loss=0.3857 [2.2s] dev=({'NDCG@5': 0.3059658495005117, 'HR@5': 0.4308289626047272}) *
INFO:root:[Stage 1][Epoch 98] loss=0.3828 [2.2s] dev=({'NDCG@5': 0.30616459264661855, 'HR@5': 0.4311695388597507}) *
INFO:root:[Stage 1][Epoch 99] loss=0.3836 [2.2s] dev=({'NDCG@5': 0.3062793052092183, 'HR@5': 0.4310333083577413}) *
INFO:root:[Stage 1][Epoch 100] loss=0.3832 [2.2s] dev=({'NDCG@5': 0.3071080290614888, 'HR@5': 0.431782576118793}) *
INFO:root:[Stage 1][Epoch 101] loss=0.3778 [2.2s] dev=({'NDCG@5': 0.3074315667322682, 'HR@5': 0.4325318438798447}) *
INFO:root:[Stage 1][Epoch 102] loss=0.3744 [2.2s] dev=({'NDCG@5': 0.30767319958453143, 'HR@5': 0.4327361896328588}) *
INFO:root:[Stage 1][Epoch 103] loss=0.3744 [2.2s] dev=({'NDCG@5': 0.3079626920475226, 'HR@5': 0.4333492268919011}) *
INFO:root:[Stage 1][Epoch 104] loss=0.3727 [2.2s] dev=({'NDCG@5': 0.3082485365685319, 'HR@5': 0.4332811116408964}) *
INFO:root:[Stage 1][Epoch 105] loss=0.3676 [2.2s] dev=({'NDCG@5': 0.30836301718687464, 'HR@5': 0.43362168789591987}) *
INFO:root:[Stage 1][Epoch 106] loss=0.3668 [2.2s] dev=({'NDCG@5': 0.30884075574066916, 'HR@5': 0.4343028404059669}) *
INFO:root:[Stage 1][Epoch 107] loss=0.3684 [2.2s] dev=({'NDCG@5': 0.3093328165955258, 'HR@5': 0.43484776241400447}) *
INFO:root:[Stage 1][Epoch 108] loss=0.3663 [2.2s] dev=({'NDCG@5': 0.30955915659417776, 'HR@5': 0.4353926844220421}) *
INFO:root:[Stage 1][Epoch 109] loss=0.3628 [2.2s] dev=({'NDCG@5': 0.30992330588310135, 'HR@5': 0.4357332606770656}) *
INFO:root:[Stage 1][Epoch 110] loss=0.3597 [2.2s] dev=({'NDCG@5': 0.31007321356612316, 'HR@5': 0.43600572168108437}) *
INFO:root:[Stage 1][Epoch 111] loss=0.3597 [2.2s] dev=({'NDCG@5': 0.31041709301757936, 'HR@5': 0.4363462979361079}) *
INFO:root:[Stage 1][Epoch 112] loss=0.3599 [2.2s] dev=({'NDCG@5': 0.3105684283005897, 'HR@5': 0.4366868741911314}) *
INFO:root:[Stage 1][Epoch 113] loss=0.3566 [2.2s] dev=({'NDCG@5': 0.310715229672563, 'HR@5': 0.4362781826851032}) *
INFO:root:[Stage 1][Epoch 114] loss=0.3523 [2.2s] dev=({'NDCG@5': 0.31110580508570296, 'HR@5': 0.4368231046931408}) *
INFO:root:[Stage 1][Epoch 115] loss=0.3518 [2.2s] dev=({'NDCG@5': 0.31118332741966587, 'HR@5': 0.43709556569715957}) *
INFO:root:[Stage 1][Epoch 116] loss=0.3491 [2.2s] dev=({'NDCG@5': 0.31127576449032, 'HR@5': 0.4367549894421361}) *
INFO:root:[Stage 1][Epoch 117] loss=0.3410 [2.2s] dev=({'NDCG@5': 0.31159237581212584, 'HR@5': 0.437231796199169}) *
