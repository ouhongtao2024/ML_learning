INFO:root:Namespace(model_name='StagewiseGCN', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-29 22:51:20 ---------------------------------------------
INFO:root:
=================================
 Arguments          | Values     
=================================
 batch_size         | 512       
 c                  | 0.05      
 data_appendix      |           
 dataset            | ML_1MTOPK 
 dropout            | 0         
 early_stop         | 10        
 emb_size           | 64        
 epoch              | 500       
 eval_batch_size    | 512       
 even_layer         | 2         
 gpu                | 0         
 l2                 | 0.0       
 lr                 | 0.0001    
 main_metric        |           
 n_layers           | 3         
 n_stages           | 3         
 num_neg            | 1         
 num_workers        | 5         
 odd_layer          | 3         
 optimizer          | Adam      
 random_seed        | 0         
 save_final_results | 1         
 test_all           | 0         
 topk               | 5,10,20,50
=================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/ML_1MTOPK/BaseReader.pkl
INFO:root:[StagewiseBase] Initializing model with emb_size=64, n_layers=3
INFO:root:[StagewiseBase] Preparing stage-wise normalized adjacency matrices
INFO:root:[StagewiseBase] Stage 1 normalized adjacency matrix shape: (9159, 9159), nnz: 1146681
INFO:root:[StagewiseBase] Stage 2 normalized adjacency matrix shape: (9159, 9159), nnz: 1146681
INFO:root:[StagewiseBase] Stage 3 normalized adjacency matrix shape: (9159, 9159), nnz: 1146681
INFO:root:[StagewiseBase] Defining encoder with stage 1 norm_adj
INFO:root:#params: 586176
INFO:root:StagewiseGCN(
  (encoder): _LGCNEncoder(
    (embedding_dict): ParameterDict(
        (item_emb): Parameter containing: [torch.cuda.FloatTensor of size 3126x64 (cuda:0)]
        (user_emb): Parameter containing: [torch.cuda.FloatTensor of size 6033x64 (cuda:0)]
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.2575,NDCG@5:0.1736,HR@10:0.3730,NDCG@10:0.2106,HR@20:0.5153,NDCG@20:0.2464,HR@50:0.7568,NDCG@50:0.2940)
INFO:root:开始第 1/3 阶段训练
INFO:root:[StagewiseBase] Switched to stage 1
INFO:root:Optimizer: Adam
INFO:root:[Stage 1][Epoch 1] loss=0.9727 [58.7s] dev=({'NDCG@5': 0.2307104966910143, 'HR@5': 0.3430913348946136}) *
INFO:root:[Stage 1][Epoch 2] loss=0.8649 [57.5s] dev=({'NDCG@5': 0.22933279141500992, 'HR@5': 0.33840749414519905})
INFO:root:[Stage 1][Epoch 3] loss=0.8248 [57.7s] dev=({'NDCG@5': 0.22944727032858234, 'HR@5': 0.3399687743950039})
INFO:root:[Stage 1][Epoch 4] loss=0.8116 [57.6s] dev=({'NDCG@5': 0.23089226881464436, 'HR@5': 0.3434816549570648}) *
INFO:root:[Stage 1][Epoch 5] loss=0.7964 [58.0s] dev=({'NDCG@5': 0.2371997861419339, 'HR@5': 0.35675253708040594}) *
INFO:root:[Stage 1][Epoch 6] loss=0.7436 [64.0s] dev=({'NDCG@5': 0.2460689354419724, 'HR@5': 0.3692427790788447}) *
INFO:root:[Stage 1][Epoch 7] loss=0.6956 [64.6s] dev=({'NDCG@5': 0.24490961081178358, 'HR@5': 0.37236533957845436})
INFO:root:[Stage 1][Epoch 8] loss=0.6817 [64.6s] dev=({'NDCG@5': 0.24289625817855828, 'HR@5': 0.36885245901639346})
INFO:root:[Stage 1][Epoch 9] loss=0.6783 [64.7s] dev=({'NDCG@5': 0.24330781343063201, 'HR@5': 0.36846213895394225})
INFO:root:[Stage 1][Epoch 10] loss=0.6754 [64.4s] dev=({'NDCG@5': 0.24333044888493022, 'HR@5': 0.36846213895394225})
INFO:root:[Stage 1][Epoch 11] loss=0.6745 [64.0s] dev=({'NDCG@5': 0.2431563228823397, 'HR@5': 0.36807181889149104})
INFO:root:[Stage 1][Epoch 12] loss=0.6743 [70.9s] dev=({'NDCG@5': 0.24261941882345853, 'HR@5': 0.36807181889149104})
INFO:root:[Stage 1][Epoch 13] loss=0.6685 [71.4s] dev=({'NDCG@5': 0.24272625161599137, 'HR@5': 0.36807181889149104})
INFO:root:[Stage 1][Epoch 14] loss=0.6666 [71.8s] dev=({'NDCG@5': 0.2443813994665376, 'HR@5': 0.3700234192037471})
INFO:root:[Stage 1][Epoch 15] loss=0.6626 [71.6s] dev=({'NDCG@5': 0.2458617875043071, 'HR@5': 0.3708040593286495})
INFO:root:在第 1 阶段第 15 轮发生早停
INFO:root:开始第 2/3 阶段训练
INFO:root:[StagewiseBase] Switched to stage 2
INFO:root:Optimizer: Adam
INFO:root:[Stage 2][Epoch 1] loss=1.5873 [140.1s] dev=({'NDCG@5': 0.24728132908585018, 'HR@5': 0.3758782201405152}) *
INFO:root:[Stage 2][Epoch 2] loss=1.5534 [141.1s] dev=({'NDCG@5': 0.2486672842293761, 'HR@5': 0.3766588602654176}) *
INFO:root:[Stage 2][Epoch 3] loss=1.5351 [135.6s] dev=({'NDCG@5': 0.24905803746806607, 'HR@5': 0.375487900078064}) *
INFO:root:[Stage 2][Epoch 4] loss=1.5152 [130.8s] dev=({'NDCG@5': 0.25122169147928997, 'HR@5': 0.3801717408274785}) *
INFO:root:[Stage 2][Epoch 5] loss=1.4941 [127.5s] dev=({'NDCG@5': 0.2529441226064992, 'HR@5': 0.37822014051522246}) *
INFO:root:[Stage 2][Epoch 6] loss=1.4717 [149.5s] dev=({'NDCG@5': 0.25454198131478517, 'HR@5': 0.3797814207650273}) *
INFO:root:[Stage 2][Epoch 7] loss=1.4498 [156.3s] dev=({'NDCG@5': 0.25664641121631504, 'HR@5': 0.382903981264637}) *
