INFO:root:Namespace(model_name='AblationStagewiseGCN', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-30 01:12:41 ---------------------------------------------
INFO:root:
===========================================
 Arguments          | Values               
===========================================
 batch_size         | 512                 
 c                  | 0.1                 
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0                   
 early_stop         | 10                  
 emb_size           | 64                  
 enabled_stage      | 1                   
 epoch              | 500                 
 eval_batch_size    | 512                 
 even_layer         | 4                   
 gpu                | 0                   
 l2                 | 0.0                 
 lr                 | 0.0001              
 main_metric        |                     
 n_layers           | 3                   
 n_stages           | 3                   
 num_neg            | 1                   
 num_workers        | 5                   
 odd_layer          | 3                   
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 test_all           | 0                   
 topk               | 5,10,20,50          
===========================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:[StagewiseBase] Initializing model with emb_size=64, n_layers=3
INFO:root:[StagewiseBase] Preparing stage-wise normalized adjacency matrices
INFO:root:[StagewiseBase] Stage 1 normalized adjacency matrix shape: (23396, 23396), nnz: 267180
INFO:root:[StagewiseBase] Stage 2 normalized adjacency matrix shape: (23396, 23396), nnz: 267180
INFO:root:[StagewiseBase] Stage 3 normalized adjacency matrix shape: (23396, 23396), nnz: 267180
INFO:root:[StagewiseBase] Defining encoder with stage 1 norm_adj
INFO:root:#params: 1497344
INFO:root:AblationStagewiseGCN(
  (encoder): _LGCNEncoder(
    (embedding_dict): ParameterDict(
        (item_emb): Parameter containing: [torch.cuda.FloatTensor of size 8714x64 (cuda:0)]
        (user_emb): Parameter containing: [torch.cuda.FloatTensor of size 14682x64 (cuda:0)]
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.1367,NDCG@5:0.0915,HR@10:0.2163,NDCG@10:0.1169,HR@20:0.3430,NDCG@20:0.1487,HR@50:0.6253,NDCG@50:0.2044)
INFO:root:开始第 1/3 阶段训练
INFO:root:[StagewiseBase] Switched to stage 1
INFO:root:Optimizer: Adam
INFO:root:[Stage 1][Epoch 1] loss=1.1636 [9.0s] dev=({'NDCG@5': 0.16480407189603619, 'HR@5': 0.25665826578570944}) *
INFO:root:[Stage 1][Epoch 2] loss=0.9872 [12.6s] dev=({'NDCG@5': 0.24107117623489685, 'HR@5': 0.3516109256862612}) *
INFO:root:[Stage 1][Epoch 3] loss=0.8513 [19.5s] dev=({'NDCG@5': 0.2462883056655998, 'HR@5': 0.35665145426060896}) *
INFO:root:[Stage 1][Epoch 4] loss=0.8239 [19.4s] dev=({'NDCG@5': 0.2525455020898673, 'HR@5': 0.36482528438117295}) *
INFO:root:[Stage 1][Epoch 5] loss=0.7993 [19.5s] dev=({'NDCG@5': 0.2603415372330495, 'HR@5': 0.37538314828690145}) *
INFO:root:[Stage 1][Epoch 6] loss=0.7757 [17.6s] dev=({'NDCG@5': 0.2667957413348572, 'HR@5': 0.38485116817655474}) *
INFO:root:[Stage 1][Epoch 7] loss=0.7505 [19.6s] dev=({'NDCG@5': 0.2742985099887785, 'HR@5': 0.3945916490702268}) *
INFO:root:[Stage 1][Epoch 8] loss=0.7220 [19.5s] dev=({'NDCG@5': 0.28003102022546755, 'HR@5': 0.3996321776445746}) *
INFO:root:[Stage 1][Epoch 9] loss=0.6971 [18.4s] dev=({'NDCG@5': 0.28428883520792764, 'HR@5': 0.4048089367209318}) *
INFO:root:[Stage 1][Epoch 10] loss=0.6724 [19.4s] dev=({'NDCG@5': 0.2869984586601893, 'HR@5': 0.4078060077651386}) *
INFO:root:[Stage 1][Epoch 11] loss=0.6485 [19.5s] dev=({'NDCG@5': 0.28842932195811993, 'HR@5': 0.4088958517812138}) *
INFO:root:[Stage 1][Epoch 12] loss=0.6315 [19.5s] dev=({'NDCG@5': 0.29004613549533254, 'HR@5': 0.4107349635583407}) *
INFO:root:[Stage 1][Epoch 13] loss=0.6232 [18.3s] dev=({'NDCG@5': 0.2907588530319379, 'HR@5': 0.41202915332743}) *
INFO:root:[Stage 1][Epoch 14] loss=0.6130 [19.5s] dev=({'NDCG@5': 0.2912062873087664, 'HR@5': 0.4119610380764253}) *
INFO:root:[Stage 1][Epoch 15] loss=0.5921 [19.5s] dev=({'NDCG@5': 0.2923150436340789, 'HR@5': 0.4135958041005381}) *
INFO:root:[Stage 1][Epoch 16] loss=0.5845 [19.5s] dev=({'NDCG@5': 0.29333069348601404, 'HR@5': 0.4145494176146039}) *
INFO:root:[Stage 1][Epoch 17] loss=0.5757 [18.5s] dev=({'NDCG@5': 0.2943831309370565, 'HR@5': 0.41611606838771203}) *
INFO:root:[Stage 1][Epoch 18] loss=0.5738 [22.5s] dev=({'NDCG@5': 0.29546962601360144, 'HR@5': 0.4176827191608201}) *
INFO:root:[Stage 1][Epoch 19] loss=0.5571 [23.7s] dev=({'NDCG@5': 0.2967428989537226, 'HR@5': 0.4194537156869423}) *
INFO:root:[Stage 1][Epoch 20] loss=0.5513 [23.0s] dev=({'NDCG@5': 0.2971698071201659, 'HR@5': 0.4198624071929705}) *
INFO:root:[Stage 1][Epoch 21] loss=0.5449 [23.6s] dev=({'NDCG@5': 0.2979629844419738, 'HR@5': 0.42088413595804103}) *
INFO:root:[Stage 1][Epoch 22] loss=0.5396 [23.6s] dev=({'NDCG@5': 0.2992990494930236, 'HR@5': 0.4225870172331585}) *
INFO:root:[Stage 1][Epoch 23] loss=0.5294 [23.8s] dev=({'NDCG@5': 0.3002826473279473, 'HR@5': 0.4239493222532525}) *
INFO:root:[Stage 1][Epoch 24] loss=0.5220 [22.7s] dev=({'NDCG@5': 0.300629842531512, 'HR@5': 0.4237449765002384}) *
INFO:root:[Stage 1][Epoch 25] loss=0.5115 [23.6s] dev=({'NDCG@5': 0.30105839247869143, 'HR@5': 0.4242217832572713}) *
INFO:root:[Stage 1][Epoch 26] loss=0.5108 [23.5s] dev=({'NDCG@5': 0.3022666004277054, 'HR@5': 0.4261971255364076}) *
INFO:root:[Stage 1][Epoch 27] loss=0.5051 [22.6s] dev=({'NDCG@5': 0.30208794223660274, 'HR@5': 0.426333356038417})
INFO:root:[Stage 1][Epoch 28] loss=0.4976 [23.6s] dev=({'NDCG@5': 0.3030054062383135, 'HR@5': 0.4268782780464546}) *
INFO:root:[Stage 1][Epoch 29] loss=0.4884 [23.6s] dev=({'NDCG@5': 0.3034535754725066, 'HR@5': 0.4272869695524828}) *
INFO:root:[Stage 1][Epoch 30] loss=0.4880 [23.6s] dev=({'NDCG@5': 0.30433967489199637, 'HR@5': 0.4287855050745862}) *
INFO:root:[Stage 1][Epoch 31] loss=0.4789 [22.6s] dev=({'NDCG@5': 0.30521354211780016, 'HR@5': 0.4300796948436755}) *
INFO:root:[Stage 1][Epoch 32] loss=0.4745 [23.6s] dev=({'NDCG@5': 0.30567352667297176, 'HR@5': 0.4303521558476943}) *
INFO:root:[Stage 1][Epoch 33] loss=0.4738 [23.6s] dev=({'NDCG@5': 0.30606982785571724, 'HR@5': 0.431101423608746}) *
INFO:root:[Stage 1][Epoch 34] loss=0.4635 [23.4s] dev=({'NDCG@5': 0.30647564490297957, 'HR@5': 0.43130576936176007}) *
INFO:root:[Stage 1][Epoch 35] loss=0.4637 [23.4s] dev=({'NDCG@5': 0.3072086285341505, 'HR@5': 0.4325318438798447}) *
INFO:root:[Stage 1][Epoch 36] loss=0.4588 [23.4s] dev=({'NDCG@5': 0.307301345117623, 'HR@5': 0.4322593828758259}) *
INFO:root:[Stage 1][Epoch 37] loss=0.4527 [23.6s] dev=({'NDCG@5': 0.30788900751499415, 'HR@5': 0.4327361896328588}) *
INFO:root:[Stage 1][Epoch 38] loss=0.4487 [22.7s] dev=({'NDCG@5': 0.3087377742300988, 'HR@5': 0.433826033648934}) *
INFO:root:[Stage 1][Epoch 39] loss=0.4445 [23.5s] dev=({'NDCG@5': 0.30873587735717933, 'HR@5': 0.4340984946529528})
INFO:root:[Stage 1][Epoch 40] loss=0.4442 [23.6s] dev=({'NDCG@5': 0.3092931088865292, 'HR@5': 0.4349158776650092}) *
INFO:root:[Stage 1][Epoch 41] loss=0.4342 [23.5s] dev=({'NDCG@5': 0.3096954663872387, 'HR@5': 0.4352564539200327}) *
INFO:root:[Stage 1][Epoch 42] loss=0.4347 [22.5s] dev=({'NDCG@5': 0.31005270315557365, 'HR@5': 0.4351202234180233}) *
INFO:root:[Stage 1][Epoch 43] loss=0.4279 [23.6s] dev=({'NDCG@5': 0.31025265578579675, 'HR@5': 0.43484776241400447}) *
INFO:root:[Stage 1][Epoch 44] loss=0.4241 [23.8s] dev=({'NDCG@5': 0.31098002420839743, 'HR@5': 0.4363462979361079}) *
INFO:root:[Stage 1][Epoch 45] loss=0.4210 [22.8s] dev=({'NDCG@5': 0.31143274483293976, 'HR@5': 0.4367549894421361}) *
INFO:root:[Stage 1][Epoch 46] loss=0.4182 [23.5s] dev=({'NDCG@5': 0.3123695147766947, 'HR@5': 0.4379810639602207}) *
INFO:root:[Stage 1][Epoch 47] loss=0.4111 [23.5s] dev=({'NDCG@5': 0.31250007072858754, 'HR@5': 0.43825352496423947}) *
INFO:root:[Stage 1][Epoch 48] loss=0.4054 [23.5s] dev=({'NDCG@5': 0.3129253050616202, 'HR@5': 0.43832164021524417}) *
INFO:root:[Stage 1][Epoch 49] loss=0.4033 [22.8s] dev=({'NDCG@5': 0.31319987046218023, 'HR@5': 0.4389346774742865}) *
INFO:root:[Stage 1][Epoch 50] loss=0.3984 [23.6s] dev=({'NDCG@5': 0.3131742162716393, 'HR@5': 0.4378448334582113})
INFO:root:[Stage 1][Epoch 51] loss=0.4025 [23.6s] dev=({'NDCG@5': 0.31374314183072055, 'HR@5': 0.4389346774742865}) *
INFO:root:[Stage 1][Epoch 52] loss=0.3920 [23.2s] dev=({'NDCG@5': 0.31432123015677577, 'HR@5': 0.43947959948232407}) *
INFO:root:[Stage 1][Epoch 53] loss=0.3899 [23.6s] dev=({'NDCG@5': 0.31425841362521195, 'HR@5': 0.4397520604863429})
INFO:root:[Stage 1][Epoch 54] loss=0.3820 [23.5s] dev=({'NDCG@5': 0.3147916308733063, 'HR@5': 0.4407737892514134}) *
INFO:root:[Stage 1][Epoch 55] loss=0.3801 [23.7s] dev=({'NDCG@5': 0.3152675077510157, 'HR@5': 0.4402969824943805}) *
INFO:root:[Stage 1][Epoch 56] loss=0.3737 [23.0s] dev=({'NDCG@5': 0.315873926107504, 'HR@5': 0.4412505960084463}) *
INFO:root:[Stage 1][Epoch 57] loss=0.3714 [24.0s] dev=({'NDCG@5': 0.31605405891440175, 'HR@5': 0.441999863769498}) *
INFO:root:[Stage 1][Epoch 58] loss=0.3653 [23.8s] dev=({'NDCG@5': 0.3162403592450281, 'HR@5': 0.44179551801648387}) *
INFO:root:[Stage 1][Epoch 59] loss=0.3602 [23.9s] dev=({'NDCG@5': 0.31650679008520743, 'HR@5': 0.4424766705265309}) *
INFO:root:[Stage 1][Epoch 60] loss=0.3606 [24.0s] dev=({'NDCG@5': 0.31682036703917416, 'HR@5': 0.442681016279545}) *
INFO:root:[Stage 1][Epoch 61] loss=0.3609 [23.9s] dev=({'NDCG@5': 0.3165731576881411, 'HR@5': 0.4423404400245215})
INFO:root:[Stage 1][Epoch 62] loss=0.3521 [23.9s] dev=({'NDCG@5': 0.3171850543081038, 'HR@5': 0.4435665145426061}) *
INFO:root:[Stage 1][Epoch 63] loss=0.3454 [22.8s] dev=({'NDCG@5': 0.3167409828451775, 'HR@5': 0.44295347728356377})
INFO:root:[Stage 1][Epoch 64] loss=0.3389 [23.8s] dev=({'NDCG@5': 0.31748895535051885, 'HR@5': 0.44411143655064367}) *
INFO:root:[Stage 1][Epoch 65] loss=0.3383 [23.9s] dev=({'NDCG@5': 0.31748351082722115, 'HR@5': 0.4443157823036578})
INFO:root:[Stage 1][Epoch 66] loss=0.3384 [23.8s] dev=({'NDCG@5': 0.31814116279933213, 'HR@5': 0.4445882433076766}) *
INFO:root:[Stage 1][Epoch 67] loss=0.3345 [24.0s] dev=({'NDCG@5': 0.31843541061734143, 'HR@5': 0.4445201280566719}) *
INFO:root:[Stage 1][Epoch 68] loss=0.3256 [24.0s] dev=({'NDCG@5': 0.31817125426023385, 'HR@5': 0.4437027450446155})
INFO:root:[Stage 1][Epoch 69] loss=0.3224 [23.8s] dev=({'NDCG@5': 0.3183615553995404, 'HR@5': 0.4437708602956202})
INFO:root:[Stage 1][Epoch 70] loss=0.3214 [23.2s] dev=({'NDCG@5': 0.3188166860415798, 'HR@5': 0.44404332129963897}) *
INFO:root:[Stage 1][Epoch 71] loss=0.3174 [23.8s] dev=({'NDCG@5': 0.3192031864165859, 'HR@5': 0.4443838975546625}) *
INFO:root:[Stage 1][Epoch 72] loss=0.3167 [23.8s] dev=({'NDCG@5': 0.318919235209543, 'HR@5': 0.44424766705265306})
INFO:root:[Stage 1][Epoch 73] loss=0.3102 [24.0s] dev=({'NDCG@5': 0.3191429874721281, 'HR@5': 0.4445201280566719})
INFO:root:[Stage 1][Epoch 74] loss=0.3074 [24.0s] dev=({'NDCG@5': 0.31944094458307826, 'HR@5': 0.4447925890606907}) *
INFO:root:[Stage 1][Epoch 75] loss=0.3012 [23.8s] dev=({'NDCG@5': 0.319478590394223, 'HR@5': 0.44424766705265306}) *
INFO:root:[Stage 1][Epoch 76] loss=0.3006 [24.0s] dev=({'NDCG@5': 0.3197835058148467, 'HR@5': 0.4446563585586813}) *
INFO:root:[Stage 1][Epoch 77] loss=0.2990 [22.5s] dev=({'NDCG@5': 0.3192462890767682, 'HR@5': 0.44411143655064367})
INFO:root:[Stage 1][Epoch 78] loss=0.2976 [23.7s] dev=({'NDCG@5': 0.32061370610837603, 'HR@5': 0.4459505483277706}) *
INFO:root:[Stage 1][Epoch 79] loss=0.2893 [23.9s] dev=({'NDCG@5': 0.32074312086843443, 'HR@5': 0.44608677882978}) *
INFO:root:[Stage 1][Epoch 80] loss=0.2936 [24.0s] dev=({'NDCG@5': 0.32057675837025934, 'HR@5': 0.4462230093317894})
INFO:root:[Stage 1][Epoch 81] loss=0.2874 [23.8s] dev=({'NDCG@5': 0.3208010714379579, 'HR@5': 0.4459505483277706}) *
INFO:root:[Stage 1][Epoch 82] loss=0.2834 [24.0s] dev=({'NDCG@5': 0.3215467017573036, 'HR@5': 0.4469722770928411}) *
INFO:root:[Stage 1][Epoch 83] loss=0.2819 [24.0s] dev=({'NDCG@5': 0.32119665898580124, 'HR@5': 0.4459505483277706})
INFO:root:[Stage 1][Epoch 84] loss=0.2833 [23.2s] dev=({'NDCG@5': 0.3216060343216795, 'HR@5': 0.4462230093317894}) *
INFO:root:[Stage 1][Epoch 85] loss=0.2756 [23.9s] dev=({'NDCG@5': 0.3221602052370913, 'HR@5': 0.4471085075948505}) *
INFO:root:[Stage 1][Epoch 86] loss=0.2703 [24.1s] dev=({'NDCG@5': 0.32183553367633255, 'HR@5': 0.44642735508480347})
INFO:root:[Stage 1][Epoch 87] loss=0.2696 [23.8s] dev=({'NDCG@5': 0.3221459460664647, 'HR@5': 0.4470403923438458})
INFO:root:[Stage 1][Epoch 88] loss=0.2656 [24.1s] dev=({'NDCG@5': 0.32187111361678755, 'HR@5': 0.4466317008378176})
INFO:root:[Stage 1][Epoch 89] loss=0.2669 [23.9s] dev=({'NDCG@5': 0.32175993441540096, 'HR@5': 0.44608677882978})
INFO:root:[Stage 1][Epoch 90] loss=0.2653 [23.1s] dev=({'NDCG@5': 0.3221096733454242, 'HR@5': 0.4468360465908317})
INFO:root:[Stage 1][Epoch 91] loss=0.2566 [23.8s] dev=({'NDCG@5': 0.3224998076031831, 'HR@5': 0.4473809685988693}) *
INFO:root:[Stage 1][Epoch 92] loss=0.2590 [23.9s] dev=({'NDCG@5': 0.3221253651316502, 'HR@5': 0.44649547033580816})
INFO:root:[Stage 1][Epoch 93] loss=0.2589 [24.0s] dev=({'NDCG@5': 0.3218988932495005, 'HR@5': 0.4458143178257612})
INFO:root:[Stage 1][Epoch 94] loss=0.2538 [23.9s] dev=({'NDCG@5': 0.32286933955767794, 'HR@5': 0.447449083849874}) *
INFO:root:[Stage 1][Epoch 95] loss=0.2518 [23.9s] dev=({'NDCG@5': 0.3224841841552261, 'HR@5': 0.4470403923438458})
INFO:root:[Stage 1][Epoch 96] loss=0.2481 [24.1s] dev=({'NDCG@5': 0.3231411642544209, 'HR@5': 0.4477896601048975}) *
INFO:root:[Stage 1][Epoch 97] loss=0.2442 [23.2s] dev=({'NDCG@5': 0.32256857157917784, 'HR@5': 0.4469041618418364})
INFO:root:[Stage 1][Epoch 98] loss=0.2432 [24.1s] dev=({'NDCG@5': 0.3225497680514993, 'HR@5': 0.4471085075948505})
INFO:root:[Stage 1][Epoch 99] loss=0.2439 [24.1s] dev=({'NDCG@5': 0.3228089068894866, 'HR@5': 0.4472447380968599})
INFO:root:[Stage 1][Epoch 100] loss=0.2391 [24.0s] dev=({'NDCG@5': 0.3229624115709246, 'HR@5': 0.4473128533478646})
INFO:root:[Stage 1][Epoch 101] loss=0.2354 [24.2s] dev=({'NDCG@5': 0.3231112785376645, 'HR@5': 0.4477896601048975})
INFO:root:[Stage 1][Epoch 102] loss=0.2331 [24.0s] dev=({'NDCG@5': 0.32285697055685764, 'HR@5': 0.4469722770928411})
INFO:root:[Stage 1][Epoch 103] loss=0.2308 [24.1s] dev=({'NDCG@5': 0.32221023068729393, 'HR@5': 0.4461548940807847})
INFO:root:[Stage 1][Epoch 104] loss=0.2312 [23.1s] dev=({'NDCG@5': 0.32269582200240665, 'HR@5': 0.4466998160888223})
INFO:root:[Stage 1][Epoch 105] loss=0.2263 [24.2s] dev=({'NDCG@5': 0.3228975976908889, 'HR@5': 0.4471085075948505})
INFO:root:在第 1 阶段第 105 轮发生早停
INFO:root:Load model from ../model/AblationStagewiseGCN/AblationStagewiseGCN__Grocery_and_Gourmet_Food__0__lr=0.0001__l2=0.0__n_stages=3__c=0.1__odd_layer=3__even_layer=4__enabled_stage=1.pt
INFO:root:
Dev  After Training: (HR@5:0.4478,NDCG@5:0.3231,HR@10:0.5598,NDCG@10:0.3595,HR@20:0.6677,NDCG@20:0.3867,HR@50:0.8471,NDCG@50:0.4223)
INFO:root:
Test After Training: (HR@5:0.3727,NDCG@5:0.2599,HR@10:0.4909,NDCG@10:0.2982,HR@20:0.6113,NDCG@20:0.3286,HR@50:0.8152,NDCG@50:0.3689)
INFO:root:Saving top-100 recommendation results to: ../log/AblationStagewiseGCN/AblationStagewiseGCN__Grocery_and_Gourmet_Food__0__lr=0/rec-AblationStagewiseGCN-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/AblationStagewiseGCN/AblationStagewiseGCN__Grocery_and_Gourmet_Food__0__lr=0/rec-AblationStagewiseGCN-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-30 01:55:24 ---------------------------------------------
