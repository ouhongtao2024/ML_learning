INFO:root:Namespace(model_name='AblationStagewiseGCN', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-30 09:11:45 ---------------------------------------------
INFO:root:
=================================
 Arguments          | Values     
=================================
 batch_size         | 512       
 c                  | 0.1       
 data_appendix      |           
 dataset            | ML_1MTOPK 
 dropout            | 0         
 early_stop         | 10        
 emb_size           | 64        
 enabled_stage      | 2         
 epoch              | 500       
 eval_batch_size    | 512       
 even_layer         | 4         
 gpu                | 0         
 l2                 | 0.0       
 lr                 | 0.0001    
 main_metric        |           
 n_layers           | 3         
 n_stages           | 3         
 num_neg            | 1         
 num_workers        | 5         
 odd_layer          | 3         
 optimizer          | Adam      
 random_seed        | 0         
 save_final_results | 1         
 test_all           | 0         
 topk               | 5,10,20,50
=================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/ML_1MTOPK/BaseReader.pkl
INFO:root:[StagewiseBase] Initializing model with emb_size=64, n_layers=3
INFO:root:[StagewiseBase] Preparing stage-wise normalized adjacency matrices
INFO:root:[StagewiseBase] Stage 1 normalized adjacency matrix shape: (9159, 9159), nnz: 1146681
INFO:root:[StagewiseBase] Stage 2 normalized adjacency matrix shape: (9159, 9159), nnz: 1146681
INFO:root:[StagewiseBase] Stage 3 normalized adjacency matrix shape: (9159, 9159), nnz: 1146681
INFO:root:[StagewiseBase] Defining encoder with stage 1 norm_adj
INFO:root:#params: 586176
INFO:root:AblationStagewiseGCN(
  (encoder): _LGCNEncoder(
    (embedding_dict): ParameterDict(
        (item_emb): Parameter containing: [torch.cuda.FloatTensor of size 3126x64 (cuda:0)]
        (user_emb): Parameter containing: [torch.cuda.FloatTensor of size 6033x64 (cuda:0)]
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.3243,NDCG@5:0.2259,HR@10:0.4948,NDCG@10:0.2806,HR@20:0.6820,NDCG@20:0.3278,HR@50:0.9252,NDCG@50:0.3765)
INFO:root:开始第 2/3 阶段训练
INFO:root:[StagewiseBase] Switched to stage 2
INFO:root:Optimizer: Adam
INFO:root:[Stage 2][Epoch 1] loss=2.3358 [282.3s] dev=({'NDCG@5': 0.23675471560893216, 'HR@5': 0.3548009367681499}) *
INFO:root:[Stage 2][Epoch 2] loss=2.1940 [278.1s] dev=({'NDCG@5': 0.24564742688536098, 'HR@5': 0.37158469945355194}) *
INFO:root:[Stage 2][Epoch 3] loss=2.1117 [279.2s] dev=({'NDCG@5': 0.2439192233808517, 'HR@5': 0.3692427790788447})
INFO:root:[Stage 2][Epoch 4] loss=2.0892 [141.2s] dev=({'NDCG@5': 0.24328824062684698, 'HR@5': 0.3672911787665886})
INFO:root:[Stage 2][Epoch 5] loss=2.0716 [108.2s] dev=({'NDCG@5': 0.24338421425009926, 'HR@5': 0.3672911787665886})
INFO:root:[Stage 2][Epoch 6] loss=2.0548 [108.1s] dev=({'NDCG@5': 0.2400540122034511, 'HR@5': 0.36416861826697894})
INFO:root:[Stage 2][Epoch 7] loss=2.0399 [108.1s] dev=({'NDCG@5': 0.24127046511773784, 'HR@5': 0.36416861826697894})
INFO:root:[Stage 2][Epoch 8] loss=2.0259 [108.1s] dev=({'NDCG@5': 0.23963192841994269, 'HR@5': 0.36143637782982047})
INFO:root:[Stage 2][Epoch 9] loss=2.0141 [111.0s] dev=({'NDCG@5': 0.24313667892146565, 'HR@5': 0.3669008587041374})
INFO:root:[Stage 2][Epoch 10] loss=2.0013 [238.6s] dev=({'NDCG@5': 0.23983866357519865, 'HR@5': 0.3633879781420765})
INFO:root:[Stage 2][Epoch 11] loss=1.9912 [238.6s] dev=({'NDCG@5': 0.2414186607367456, 'HR@5': 0.3657298985167838})
INFO:root:在第 2 阶段第 11 轮发生早停
INFO:root:Load model from ../model/AblationStagewiseGCN/AblationStagewiseGCN__ML_1MTOPK__0__lr=0.0001__l2=0.0__n_stages=3__c=0.1__odd_layer=3__even_layer=4__enabled_stage=2.pt
INFO:root:
Dev  After Training: (HR@5:0.3716,NDCG@5:0.2456,HR@10:0.5461,NDCG@10:0.3017,HR@20:0.7358,NDCG@20:0.3494,HR@50:0.9297,NDCG@50:0.3884)
INFO:root:
Test After Training: (HR@5:0.3667,NDCG@5:0.2487,HR@10:0.5198,NDCG@10:0.2980,HR@20:0.7063,NDCG@20:0.3451,HR@50:0.9398,NDCG@50:0.3920)
INFO:root:Saving top-100 recommendation results to: ../log/AblationStagewiseGCN/AblationStagewiseGCN__ML_1MTOPK__0__lr=0/rec-AblationStagewiseGCN-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/AblationStagewiseGCN/AblationStagewiseGCN__ML_1MTOPK__0__lr=0/rec-AblationStagewiseGCN-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-30 09:45:21 ---------------------------------------------
